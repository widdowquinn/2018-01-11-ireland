{
    "collab_server" : "",
    "contents" : "---\ntitle: \"ITS1 classification\"\nauthor: \"Leighton Pritchard, Peter Thorpe\"\ndate: \"05/10/2016\"\noutput: pdf_document\n#output: \n#  revealjs::revealjs_presentation:\n#    theme: white\n#    center: true\n#    highlight: pygments\n#    transition: fade\n#    css: reveal.css\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(jpeg)\nlibrary(png)\nlibrary(grid)\n```\n\n\n# What is the goal?\n\n\n## Broadly-speaking…\n\nIdentify and profile *Phytophthora* present in a nursery\n\n> 1. Sequence sample from nursery\n> 2. Put reads into \"black box\"\n> 3. Be told which *Phytophthora* spp. are present (and in what relative quantity)\n\n\n## Amplifying ITS1\n\n```{r fig.width=10, fig.height=6, echo=FALSE}\nimg <- readPNG(\"images/its_primers.png\")\ngrid.raster(img)\n```\n\n# So what's in the box?\n\n\n## Given a set of reads…\n\n> - Assemble reads into complete ITS1 regions\n> - Compare to known ITS1 sequences (supervised) to identify originating species. Needs reliable database.\n> - Apply clustering (unsupervised) to identify originating species/novel OTUs\n> - Use abundance to estimate relative quantity of originating species\n\n\n# Clustering ITS1\n\n\n## Sequence survey 1\n\nAre either of these statements true? (not accounting for primer choice…)\n\n- There is only one ITS1 sequence per species?\n- There is only one ITS1 sequence per isolate?\n\n\n## One ITS1 per species\n\n```{r fig.width=10, fig.height=8, echo=FALSE}\nimg <- readPNG(\"images/one_its_per_species.png\")\ngrid.raster(img)\n```\n\n\n## >1 ITS1 per species\n\n```{r fig.width=4, fig.height=4, echo=FALSE}\nimg <- readPNG(\"images/tree_ITS_appiah_2004.png\")\ngrid.raster(img)\n```\n\nNJ tree of ITS1 regions from cocoa-associated *Phytophthora* spp. Appiah *et al.* (2004) *Plant Path.* doi:10.1111/j.0032-0862.2004.00980.x\n\n\n## One ITS1 per isolate\n\n```{r fig.width=10, fig.height=8, echo=FALSE}\nimg <- readPNG(\"images/one_its_per_isolate.png\")\ngrid.raster(img)\n```\n\n\n## How many ITS1 per isolate?\n\n> 1. Identify 'canonical' ITS1 sequence\n> 2. Query (`BLAST`/`HMMer`) against sequenced genomes\n> 3. Count matches\n\n\n## Six sequenced genomes\n\n- Distinct `BLAST` hits with ITS1 query\n    - *P. infestans*: 133\n    - *P. sojae*: 7\n    - *P. cinnamomi*: 2\n    - *P. kernoviae*: 1\n    - *P. ramorum*: 1\n    - *P. cambivora*: 12\n\n\n# But…\n\n\n## Assembly questions…\n\n> - ITS1/rRNA regions are repetitive\n> - Assemblies collapse repetitive regions\n> - Is there evidence of assembly collapse?\n> - Excessive read coverage to genomic ITS1 is evidence of assembly collapse\n> - Compare coverage to 'conserved, single-copy genes' (`BUSCO`)\n\n\n## Six sequenced genomes\n\n- Ratio ITS1:`BUSCO` gene coverage = estimated copy number\n    - *P. infestans*: 97\n    - *P. sojae*: 40\n    - *P. cinnamomi*: 60\n    - *P. kernoviae*: 23\n    - *P. ramorum*: 8\n    - *P. cambivora*: 84\n\n\n## >1 ITS1 per isolate\n\n```{r fig.width=10, fig.height=8, echo=FALSE}\nimg <- readPNG(\"images/several_its_per_isolate.png\")\ngrid.raster(img)\n```\n\n\n## ITS1 diversity\n\n47 sequences from *P. infestans* T30-4\n\n```{r fig.width=10, fig.height=6, echo=FALSE}\nimg <- readPNG(\"images/its_diversity.png\")\ngrid.raster(img)\n```\n\n\n## Estimating isolate ITS1 diversity\n\n> - collapsed regions not yet assembled\n> - assembly options include: `GRAbB`, `MITObim`, and `riboSEED`\n> - without assembly, estimate SNPs/phasing/profile\n\n\n## Sequence survey 2\n\nIf there is more than one ITS1 sequence per isolate…\n\n- How diverse are ITS1 sequences?\n    - <80%-100% sequence identity\n- Is there possibility for confusion in classification, or in a representative database?\n\n\n## Confusion?\n\n```{r fig.width=10, fig.height=8, echo=FALSE}\nimg <- readPNG(\"images/confusion.png\")\ngrid.raster(img)\n```\n\n\n## Confusion\n\n> - 154 'representative' ITS1 sequences\n> - Clustering using `SWARM`\n> - 122-138 clusters resulted (dependent on stringency)\n> - Potential confusion *but* so far only within a clade (*sensu* Martin *et al.*)\n\n\n## Algorithms\n\n```{r fig.width=10, fig.height=6, echo=FALSE}\nimg <- readPNG(\"images/swarm_v_greedy.png\")\ngrid.raster(img)\n```\n\n# Classification\n\n\n## Three stages\n\n> 1. **QC:** `FastQC` to clean reads\n> 2. **Assembly:** `PEAR` to assemble reads\n> 3. **Clustering:** `SWARM` to cluster reads (unsupervised) for OTUs\n\n\n## Flowchart\n\n```{r fig.width=10, fig.height=6, echo=FALSE}\nimg <- readPNG(\"images/script_flowchart.png\")\ngrid.raster(img)\n```\n\n\n## Working prototype\n\n- Still much to do, but groundwork in place\n- `PCRMIX96` testing: 10 known species\n    - 9 species present identified\n    - 8 false positives identified\n    - 1 false negative\n- Some issues due to ITS1 sequence 'confusion'\n\n\n## Validation\n\n- Influence of primers (filter)?\n- We need to establish objectively that the clustering/classification works:\n    - samples of known spp. composition to test accuracy of classification\n    - FPR, FNR, Sp, Sn, etc.\n- We need to build a representative database of ITS1\n    - genome analysis to catalogue ITS1 variation\n- Comparison against, e.g. `PIPITS` (requires database development)",
    "created" : 1511803056198.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2892275981",
    "id" : "C48A5641",
    "lastKnownWriteTime" : 1479720622,
    "last_content_update" : 1479720622,
    "path" : "~/Library/Mobile Documents/com~apple~CloudDocs/JHI_work/Presentations/2016-10-05_York_presentations/2016-10-05_ITS1.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}